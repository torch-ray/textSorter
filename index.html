<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>시간 정렬기</title>
</head>
<body>
  <h2>혜윤이의 텍스트 파일 시간 정렬기</h2>
  <p>파일의 세 번째 열에 있는 시작 시간(시:분:초)을 기준으로 오름차순 정렬합니다.</p>
  <input type="file" multiple id="fileInput">
  <button onclick="processFiles()">정렬 시작</button>

  <script>
    /**
     * '시:분:초.밀리초' 형식의 시간 문자열을 총 초 단위 숫자로 변환합니다.
     * @param {string} timeStr - 예: "00:01:54.661"
     * @returns {number|null} - 총 초 단위 시간 또는 유효하지 않은 형식일 경우 null
     */
    function parseTime(timeStr) {
      if (typeof timeStr !== 'string') {
        console.warn(`유효하지 않은 입력값입니다:`, timeStr);
        return null;
      }

      const parts = timeStr.split(':');
      if (parts.length !== 3) {
        console.warn(`'시:분:초' 형식이 아닙니다: "${timeStr}"`);
        return null;
      }

      const hours = parseInt(parts[0], 10);
      const minutes = parseInt(parts[1], 10);
      const seconds = parseFloat(parts[2]);

      if (isNaN(hours) || isNaN(minutes) || isNaN(seconds)) {
        console.warn(`시간의 일부를 숫자로 변환할 수 없습니다: "${timeStr}"`);
        return null;
      }
      
      return (hours * 3600) + (minutes * 60) + seconds;
    }

    /**
     * 파일 내용을 받아 시간 기준으로 정렬합니다.
     */
    function processFile(content) {
      const lines = content.split("\n").filter(line => line.trim());
      const entries = [];

      lines.forEach(line => {
        const parts = line.split("\t");
        if (parts.length < 3) {
          return; // 열이 3개 미만인 줄은 건너뛰기
        }

        const timeValue = parseTime(parts[2]); // 세 번째 열을 시간으로 파싱

        if (timeValue !== null) {
          entries.push({ time: timeValue, line: line });
        }
      });
      
      entries.sort((a, b) => a.time - b.time);

      return entries.map(e => e.line).join("\n");
    }

    /**
     * 사용자가 선택한 파일들을 처리하고 다운로드합니다.
     */
    function processFiles() {
      const input = document.getElementById("fileInput");
      if (input.files.length === 0) {
        alert("파일을 선택해주세요.");
        return;